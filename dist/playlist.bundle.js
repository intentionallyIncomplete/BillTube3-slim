BTFW.define("feature:nowplaying",[],async()=>{const t=(t,e=document)=>e.querySelector(t),e={lastCleanTitle:null,lastMediaKey:null,pendingUpdate:null,lastLookupInfo:null};function n(t){const e=String(t||"").trim();if(!e)return{original:"",base:"",year:"",canonical:"",query:""};const n=e.match(/\(\s*((?:19|20)\d{2})\s*\)\s*$/);let o=e,r="",i=e;if(n){r=n[1];const t=e.slice(0,n.index).trim();o=t,i=t?`${t} (${r})`:`(${r})`}else{const t=/(?:^|[\s,;:|/-])((?:19|20)\d{2})\s*$/.exec(e);if(t){r=t[1];const n=e.slice(0,t.index).replace(/[\s,;:|/-]+$/,"").trim();n?(o=n,i=`${n} (${r})`):(o=e,i=e)}}o||(o=e);return{original:e,base:o,year:r,canonical:i,query:i||o||e}}function o(t,e){if(!t||!e)return;const n=t.dataset,o=e.canonical||"",r=e.base||"",i=e.year||"",l=e.original||o||r||"",c=e.query||o||l;n.btfwLookup=o,n.btfwLookupQuery=c,n.btfwLookupBase=r,n.btfwLookupYear=i,n.btfwLookupOriginal=l}function r(r,i={}){const l=r?{original:r.original||"",base:r.base||"",year:r.year||"",canonical:r.canonical||r.query||r.original||"",query:r.query||r.canonical||r.original||""}:{original:"",base:"",year:"",canonical:"",query:""};e.lastLookupInfo=l;const a=c();a&&o(a,l);const s=t("#btfw-nowplaying-slot");s&&o(s,l);try{window.BTFW=window.BTFW||{},window.BTFW.nowPlayingLookup={...l},window.BTFW.normalizeTitleForLookup||(window.BTFW.normalizeTitleForLookup=n)}catch(t){}if(!i.skipEvent)try{document.dispatchEvent(new CustomEvent("btfw:nowplayingLookup",{detail:{...l}}))}catch(t){}}function i(t){return String(t||"").replace(/^\s*(?:currently|now)\s*playing\s*[:\-]\s*/i,"").replace(/[.]/g," ").trim()}function l(){const e=t("#chatwrap");if(!e)return null;let n=e.querySelector(".btfw-chat-topbar");n||(n=document.createElement("div"),n.className="btfw-chat-topbar",e.prepend(n));let o=n.querySelector("#btfw-nowplaying-slot");return o||(o=document.createElement("div"),o.id="btfw-nowplaying-slot",o.className="btfw-chat-title",n.appendChild(o)),o}function c(){return t("#currenttitle")||document.querySelector(".currenttitle")||null}function a(){const t=document.createElement("span");return t.id="currenttitle",t.className="btfw-nowplaying",t}function s(){const t=l();if(!t)return;let n=c();if(n||(n=a()),n.parentElement!==t){t.contains(n)||(t.innerHTML=""),t.appendChild(n),n.classList.add("btfw-nowplaying"),e.lastLookupInfo&&r(e.lastLookupInfo,{skipEvent:!0})}}function u(){const t=document.querySelector("#queue .queue_active .qe_title a, #queue .queue_active .qe_title");return t&&t.textContent?t.textContent.trim():""}function d(t,o={}){let s=c();if(!s){s=a();const t=l();t&&t.appendChild(s)}const d=i(t||s.textContent||u());if(!d)return!1;if(i(s.textContent||"")!==d||o.force){s.textContent=d;const t=n(d);return s.title=t.canonical||d,s.style.setProperty("--length",String(d.length)),e.lastCleanTitle=d,r(t),!0}return!1}function f(t,n={}){e.pendingUpdate&&clearTimeout(e.pendingUpdate),n.force?d(t,n):e.pendingUpdate=setTimeout(()=>{e.pendingUpdate=null,d(t,n)},100)}function p(t){if(t&&"object"==typeof t&&t.title){d(t.title,{force:!0}),s();const n=function(t){if(!t)return"";const e=[t.uid,t.queue?.uid,t.qe?.uid,t.temp?.uid,t.uniqueID,t.id&&t.type?`${t.type}:${t.id}`:null,t.id,t.title?i(t.title):null].map(t=>null==t?null:String(t)).filter(t=>t);return e.length?`m:${e.join("|")}`:""}(t);n&&(e.lastMediaKey=n)}}function b(){e.lastCleanTitle||(window.socket&&socket.connected?socket.emit("playerReady"):window.socket&&socket.once("connect",()=>{socket.emit("playerReady")}))}function m(){s();try{window.socket&&socket.on&&(socket.on("changeMedia",p),socket.on("setCurrent",p),socket.on("mediaUpdate",t=>{t&&t.title&&f(t.title,{force:!1}),s()}))}catch(t){console.warn("[nowplaying] Socket not available:",t)}try{if(window.Callbacks&&Callbacks.changeMedia){const t=Callbacks.changeMedia;Callbacks.changeMedia=function(e){t(e),p(e)}}}catch(t){console.warn("[nowplaying] Could not override Callbacks.changeMedia:",t)}const e=t("#queue");if(e&&!e._btfwNPObs){const t=new MutationObserver(()=>{const t=u();t&&f(t),s()});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class"]}),e._btfwNPObs=t}if(!document._btfwNpMoveObs){const e=new MutationObserver(()=>{const e=c(),n=t("#btfw-nowplaying-slot");e&&n&&!n.contains(e)&&s()});e.observe(document.body,{childList:!0,subtree:!0}),document._btfwNpMoveObs=e}setTimeout(b,500),setTimeout(b,2e3),document.addEventListener("btfw:ready",()=>{setTimeout(b,500)}),[500,1500].forEach(t=>{setTimeout(()=>{s();const t=c();if(t&&t.textContent){const e=t.textContent.trim();e&&d(e,{force:!0})}},t)})}return"loading"===document.readyState?document.addEventListener("DOMContentLoaded",m):m(),{name:"feature:nowplaying",setTitle:d,mountTitleIntoSlot:s}}),BTFW.define("feature:playlistPerformance",[],function(){const t=t=>document.querySelector(t);let e=!1,n=new Map,o=1/0,r=null;function i(){return t("#queue")}function l(){const t=i();return t?Array.from(t.children).filter(t=>"btfw-playlist-performance-indicator"!==t.id):[]}function c(t){if(!t)return;const e=t.querySelector(".btn-group");if(!e||e.querySelector(".btfw-qbtn-pollcopy"))return;const n=document.createElement("button");n.type="button",n.className="btn btn-xs btn-default qbtn-pollcopy btfw-qbtn-pollcopy",n.title="Add this title to the poll",n.textContent="Poll";const o=e.querySelector(".qbtn-next");o&&o.nextSibling?e.insertBefore(n,o.nextSibling):e.appendChild(n)}function a(t){const e=Array.isArray(t)?t:l();if(!e.length)return;const n=Number.isFinite(o)?Math.min(e.length,o):e.length;for(let t=0;t<n;t+=1){const n=e[t];n&&"none"!==n.style.display&&!n.hidden&&c(n)}}function s(t){t.forEach((t,e)=>{if(n.has(t)||n.set(t,t.style.display||""),e<o){const e=n.get(t);t.style.display=void 0===e?"":e}else t.style.display="none"}),a(t)}function u(t){t&&r&&t.removeEventListener("scroll",r),r=null}function d(e){const n=t("#btfw-playlist-performance-indicator");if(!n)return;n.dataset.totalCount=e;const r=n.querySelector(".btfw-perf-status");if(!r)return;const i=Math.max(e-Math.min(o,e),0),l=e-i;r.textContent=i>0?`Showing ${l} of ${e} items (${i} hidden for performance)`:`Showing all ${e} items`;const c=n.querySelector("#btfw-show-more-items");c&&(c.disabled=0===i,c.style.opacity=0===i?"0.5":"1");const a=n.querySelector("#btfw-show-all-items");a&&(a.disabled=0===i,a.style.opacity=0===i?"0.5":"1")}function f(){const t=i();if(!t)return;const n=l();if(!n.length)return;e&&Number.isFinite(o)||(o=120),o=Math.min(n.length,Math.max(o,120)),s(n),e=!0,function(t){b();const e=i();if(!e)return;const n=document.createElement("div");n.id="btfw-playlist-performance-indicator",n.className="playlist-performance-indicator",n.style.cssText="\n      padding: 10px;\n      margin: 10px 0;\n      background: rgba(0, 150, 0, 0.1);\n      border: 1px solid rgba(0, 150, 0, 0.3);\n      border-radius: 4px;\n      text-align: center;\n      color: #0f0;\n      font-size: 12px;\n    ",n.innerHTML='\n      <i class="fa fa-rocket"></i> Performance Mode Active<br>\n      <small class="btfw-perf-status"></small><br>\n      <div class="btfw-perf-controls" style="margin-top: 5px; display: flex; gap: 6px; justify-content: center; flex-wrap: wrap;">\n        <button id="btfw-show-more-items" class="btn btn-xs btn-default">Show More</button>\n        <button id="btfw-show-all-items" class="btn btn-xs btn-default">Show All (May Lag)</button>\n      </div>\n    ',e.appendChild(n);const o=n.querySelector("#btfw-show-more-items");o&&o.addEventListener("click",()=>{m()});const r=n.querySelector("#btfw-show-all-items");r&&r.addEventListener("click",()=>{p()});d(t)}(n.length),d(n.length),u(t),r=()=>{e&&t.scrollTop+t.clientHeight>=t.scrollHeight-300&&m()},t.addEventListener("scroll",r,{passive:!0})}function p(){const t=i(),r=l();r.forEach(t=>{const e=n.get(t);t.style.display=void 0===e?"":e}),n.clear(),o=1/0,a(r),e=!1,t&&u(t),b()}function b(){const e=t("#btfw-playlist-performance-indicator");e&&e.remove()}function m(){const t=i(),e=l();if(!t||!e.length)return;const n=o;o=Math.min(e.length,o+80),o!==n&&(s(e),d(e.length))}function y(){const n=t("#btfw-pl-scroll");n&&!n._perfEnhanced&&(n._perfEnhanced=!0,n.addEventListener("click",t=>{e&&(t.preventDefault(),t.stopPropagation(),function(){const t=i();if(!t)return;const n=t.querySelector(".queue_active");if(!n)return;const r=l(),c=r.indexOf(n);if(c>-1){const t=25;if(e){const e=Math.min(r.length,Math.max(o,c+t+1));o=Math.max(e,2*t),o=Math.min(r.length,o),s(r),d(r.length)}n.scrollIntoView({behavior:"smooth",block:"center"})}}())}))}function w(){if(!i())return;if(l().length>100&&!e){f();const e=t("#btfw-perf-toggle");e&&(e.classList.add("btn-success"),e.innerHTML='<i class="fa fa-rocket"></i> Performance ON')}}function g(){!function(){const n=t(".btfw-pl-toolbar");if(!n||n.querySelector("#btfw-perf-toggle"))return;const o=document.createElement("button");o.id="btfw-perf-toggle",o.className="btn btn-xs btn-default",o.innerHTML='<i class="fa fa-rocket"></i> Performance',o.title="Toggle performance mode for smooth scrolling",o.style.marginLeft="5px",o.addEventListener("click",()=>{e?(p(),o.classList.remove("btn-success"),o.innerHTML='<i class="fa fa-rocket"></i> Performance'):(f(),o.classList.add("btn-success"),o.innerHTML='<i class="fa fa-rocket"></i> Performance ON')}),n.appendChild(o)}(),function(){const n=t('.btfw-stack-item[data-bind="playlist-group"]');if(!n)return;const o=n.querySelector(".btfw-stack-item__header");if(!o||o.querySelector("#btfw-stack-perf-toggle"))return;const r=document.createElement("button");r.id="btfw-stack-perf-toggle",r.className="btfw-stack-perf-btn",r.innerHTML="‚ö°",r.title="Performance mode - hide excess items",r.style.cssText="\n      background: rgba(0, 150, 0, 0.2);\n      border: 1px solid rgba(0, 150, 0, 0.4);\n      color: #0f0;\n      padding: 2px 8px;\n      margin: 0 5px;\n      border-radius: 3px;\n      cursor: pointer;\n      font-size: 14px;\n    ",r.addEventListener("click",t=>{t.stopPropagation(),e?(p(),r.style.background="rgba(0, 150, 0, 0.2)",r.innerHTML="‚ö°"):(f(),r.style.background="rgba(0, 150, 0, 0.5)",r.innerHTML="‚ö° ON")});const i=o.querySelector(".btfw-stack-arrows");i?o.insertBefore(r,i):o.appendChild(r)}(),y(),function(){const t=i();if(!t||t._perfWatched)return;t._perfWatched=!0,new MutationObserver(t=>{t.some(t=>{const e=Array.from(t.addedNodes||[]),n=Array.from(t.removedNodes||[]),o=t=>t instanceof HTMLElement&&"btfw-playlist-performance-indicator"!==t.id&&(t.classList.contains("queue_entry")||!!t.querySelector?.(".queue_entry"));return e.some(o)||n.some(o)})&&(e&&setTimeout(()=>{f()},100),w())}).observe(t,{childList:!0,subtree:!1})}(),w()}return"loading"===document.readyState?document.addEventListener("DOMContentLoaded",g):g(),document.addEventListener("btfw:layoutReady",g),window.BTFW_PlaylistPerformance={optimize:f,restore:p,toggle:()=>e?p():f(),isOptimized:()=>e},{name:"feature:playlistPerformance"}}),BTFW.define("feature:playlist-tools",[],async()=>{const t=(t,e=document)=>e.querySelector(t),e=(t,e=document)=>Array.from(e.querySelectorAll(t));function n(){if(t("#btfw-plbar"))return;const e=t("#playlistwrap")||t("#ploptions")||t("#queue")?.parentElement||t("#queue")?.closest(".well")||t("#btfw-leftpad");if(!e)return;const n=document.createElement("div");n.id="btfw-plbar",n.className="btfw-plbar",n.innerHTML='\n      <div class="field has-addons" style="margin:0;">\n        <p class="control is-expanded">\n          <input id="btfw-pl-filter" class="input is-small" type="text" placeholder="Filter playlist‚Ä¶">\n        </p>\n        <p class="control">\n          <button id="btfw-pl-clear" class="button is-small" title="Clear filter"><i class="fa fa-times"></i></button>\n        </p>\n        <p class="control">\n          <button id="btfw-pl-scroll" class="button is-small" title="Scroll to current"><i class="fa fa-location-arrow"></i></button>\n        </p>\n      </div>\n      <span id="btfw-pl-count" class="is-size-7" style="opacity:.75;"></span>\n    ',e.insertBefore(n,e.firstChild),function(){const e=t("#btfw-pl-filter"),n=t("#btfw-pl-clear");if(!e)return;const o=function(t,e){let n;return(...o)=>{clearTimeout(n),n=setTimeout(()=>t(...o),e)}}(()=>{const t=e.value||"";t!==s&&(s=t,u(t))},120);e.addEventListener("input",o),n.addEventListener("click",t=>{t.preventDefault(),e.value="",s="",u(""),e.focus()})}(),function(){const e=t("#btfw-pl-scroll"),n=t("#queue");if(!e||!n)return;e.addEventListener("click",e=>{e.preventDefault();const o=t("#queue .queue_active");if(!o)return;const r=o.getBoundingClientRect(),i=n.getBoundingClientRect();n.scrollTop+=r.top-i.top-.3*i.height})}(),d()}let o=!1,r=null;function i(){const e=t("#btfw-plbar");if(!e)return;let n=e.querySelector(".btfw-plbar__actions");if(n||(n=document.createElement("div"),n.className="btfw-plbar__actions",e.appendChild(n)),r&&r.isConnected)return void l();const i=document.createElement("button");i.type="button",i.id="btfw-pl-copytoggle",i.className="button is-dark is-small btfw-plbar__action-btn",i.textContent="Copy titles",i.setAttribute("aria-pressed",o?"true":"false"),i.addEventListener("click",()=>{o=!o,l(),c(),q(o?"Copy buttons enabled":"Copy buttons disabled","info")}),n.appendChild(i),r=i,l()}function l(){r&&(r.setAttribute("aria-pressed",o?"true":"false"),r.classList.toggle("is-success",o),r.classList.toggle("is-dark",!o),r.classList.toggle("is-outlined",o))}function c(){const t=e("#queue > .queue_entry");t.length&&t.forEach(t=>{const e=t.querySelector(".btn-group");if(!e)return;const n=e.querySelector(".btfw-qbtn-copytitle");if(o){if(n)return;const t=document.createElement("button");t.type="button",t.className="btn btn-xs btn-default qbtn-copytitle btfw-qbtn-copytitle",t.setAttribute("title","Copy title and URL"),t.innerHTML='<span class="glyphicon glyphicon-copy"></span>Copy',e.appendChild(t)}else n&&n.remove()})}async function a(t){if(!t)return!1;const e=t.querySelector(".qe_title")||t.querySelector("a");if(!e)return!1;const n=(e.textContent||"").trim(),o=e.getAttribute("href")||"";if(!n||!o)return!1;const r=function(t){if(!t)return"";let e=String(t).trim();if(!e)return"";const n=e.match(/\b(19|20)\d{2}\b(?!.*\b(19|20)\d{2}\b)/);let o="";if(n){o=n[0];const t=n.index??e.indexOf(o);t>-1&&(e=`${e.slice(0,t)} ${e.slice(t+o.length)}`)}e=e.replace(/\s+/g," ").trim();const r=e.replace(/\b([A-Za-z][^\s]*)/g,t=>t.toUpperCase()===t?t:t.charAt(0).toUpperCase()+t.slice(1).toLowerCase());return o?`${r}${r?" ":""}(${o})`:r}(n),i=r?`${o} ${r}`:o,l=await async function(t){if(!t)return!1;try{if(navigator.clipboard?.writeText)return await navigator.clipboard.writeText(t),!0}catch(t){}try{const e=document.createElement("textarea");e.value=t,e.style.position="fixed",e.style.opacity="0",document.body.appendChild(e),e.focus(),e.select();const n=document.execCommand("copy");return document.body.removeChild(e),n}catch(t){}return!1}(i);return l?q(`Copied "${r}"`,"success"):q("Unable to copy to clipboard","warn"),l}let s="";function u(n){if(!t("#queue"))return;let o=0;const r=(n||"").trim().toLowerCase();e("#queue > .queue_entry").forEach(t=>{const e=(t.textContent||"").toLowerCase(),n=!r||e.includes(r);t.style.display=n?"":"none",n&&o++}),d(o)}function d(n){const o=t("#btfw-pl-count"),r=t("#queue");if(!o||!r)return;const i=null!=n?n:e("#queue > .queue_entry").filter(t=>"none"!==t.style.display).length;o.textContent=i?`${i} item${1===i?"":"s"}`:""}function f(){Array.from(document.querySelectorAll("#queue > .queue_entry")).filter(t=>{const e=window.getComputedStyle(t);return"none"!==e.display&&"hidden"!==e.visibility}).slice(0,50).forEach(t=>{if(!t)return;const e=t.querySelector(".btn-group");if(!e)return;if(e.querySelector(".btfw-qbtn-pollcopy"))return;const n=document.createElement("button");n.type="button",n.className="btn btn-xs btn-default qbtn-pollcopy btfw-qbtn-pollcopy",n.setAttribute("title","Add this title to the poll"),n.textContent="Poll";const o=e.querySelector(".qbtn-next");o&&o.nextSibling?e.insertBefore(n,o.nextSibling):e.appendChild(n)})}function p(){const n=t("#queue");n&&!n._btfwPollCopyDelegated&&(n._btfwPollCopyDelegated=!0,n.addEventListener("click",t=>{const n=t.target.closest?.(".btfw-qbtn-pollcopy");if(!n)return;t.preventDefault(),t.stopPropagation();const o=n.closest(".queue_entry");if(!o)return;const r=o.querySelector(".qe_title")||o.querySelector("a"),i=r?(r.textContent||"").trim():"";if(!i)return void q("No title found for this entry","warn");const l=function(){const t=document.getElementById("pollwrap");if(!t||!t.isConnected)return null;const n=t.querySelector(".poll-menu");if(!n)return null;const o=window.getComputedStyle(t),r=window.getComputedStyle(n),i=t=>"none"===t||"hidden"===t||"0"===t;if(i(o.display)||i(r.display)||i(o.visibility)||i(r.visibility))return null;if(0===Number.parseFloat(o.opacity)||0===Number.parseFloat(r.opacity))return null;const l=e(".poll-menu-option",n).filter(t=>t instanceof HTMLInputElement);return l.length?l:null}();if(!l)return void q("No poll is open","warn");const c=l.find(t=>!(t.value||"").trim());c?(c.value=i,c.dispatchEvent(new Event("input",{bubbles:!0})),q("Successfully added to poll options","success")):q("No empty poll option available","warn")},!0))}const b=new RegExp(`\\b(?:${["720p","brrip","x264","yify","mp4"].join("|")})\\b`,"gi"),m=["#addfromurl-title-val","#mediaurl-title",".media-title-input"];let y=null;function w(){let t=!1;if(m.flatMap(t=>Array.from(document.querySelectorAll(t))).forEach(e=>{if(!(e instanceof HTMLInputElement))return;if(e._btfwTitleFilterBound)return void(t=!0);const n=()=>{const t=e.value||"",n=function(t){if(!t)return"";let e=String(t);return e=e.replace(/\.+/g," "),b.lastIndex=0,e=e.replace(b," "),e=e.replace(/\b(19|20)\d{2}\b/g,(t,e,n,o)=>{const r=o[n-1],i=o[n+t.length];return"("===r&&")"===i?t:`(${t})`}),e.replace(/\s+/g," ").trim()}(t);if(n===t)return;const o=e.selectionStart,r=e.selectionEnd;if(e.value=n,"number"==typeof o&&"number"==typeof r){const i=n.length-t.length,l=Math.max(0,o+i),c=Math.max(0,r+i);try{e.setSelectionRange(l,c)}catch(t){}}};e.addEventListener("input",n),e.addEventListener("change",n),e.addEventListener("paste",()=>requestAnimationFrame(n)),e._btfwTitleFilterBound=!0,n(),t=!0}),!y){const t=document.getElementById("addfromurl")||document.body;y=new MutationObserver(()=>w()),y.observe(t,{childList:!0,subtree:!0})}return t}const g="btfw:addfromurl:addTemp";let h=null;function v(){const t=document.querySelector("#addfromurl input.add-temp");if(!(t instanceof HTMLInputElement)){if(!h){const t=document.getElementById("addfromurl")||document.body;h=new MutationObserver(()=>v()),h.observe(t,{childList:!0,subtree:!0})}return!1}if(t._btfwTempPersistBound)return!0;try{const e=localStorage.getItem(g);null!=e&&(t.checked="true"===e)}catch(t){}return t.addEventListener("change",()=>{try{localStorage.setItem(g,t.checked?"true":"false")}catch(t){}}),t._btfwTempPersistBound=!0,!0}function q(t,e="info"){const n=null==t?"":String(t).trim();if(n){try{const t=window.BTFW_notify;if(t&&"function"==typeof t.notify){const r=e&&"function"==typeof t[e]?e:"info",i="info"===r?t.info:t[r],l={info:"üìù",success:"‚úÖ",warn:"‚ö†Ô∏è",error:"‚ö†Ô∏è"};return void i({title:"Playlist",html:`<span>${o=n,o.replace(/[&<>"']/g,t=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[t]))}</span>`,icon:l[r]||l.info,timeout:"success"===r?4200:5200})}}catch(t){}var o;try{if(window.makeAlert)return void makeAlert("Playlist",n).insertBefore("#motdrow")}catch(t){}console.log("[playlist-tools]",n)}}function L(){n(),i(),f(),c(),function(){const e=t("#queue");e&&!e._btfwCopyTitleDelegated&&(e._btfwCopyTitleDelegated=!0,e.addEventListener("click",t=>{const e=t.target.closest?.(".btfw-qbtn-copytitle");e&&(t.preventDefault(),t.stopPropagation(),a(e.closest(".queue_entry")))},!0))}(),p(),w(),v(),function(){const e=t("#queuecontainer")||t("#playlistwrap")||document.body;if(e&&!e._btfw_pl_obs_optimized){let t;e._btfw_pl_obs_optimized=!0,new MutationObserver(()=>{clearTimeout(t),t=setTimeout(()=>{n(),i(),f(),c(),w(),v()},100)}).observe(e,{childList:!0,subtree:!0})}const o=t("#queue");if(o&&!o._btfw_pl_count_obs_optimized){let t;o._btfw_pl_count_obs_optimized=!0,new MutationObserver(()=>{clearTimeout(t),t=setTimeout(()=>{d(),f(),c()},100)}).observe(o,{childList:!0,subtree:!1})}}()}return"loading"===document.readyState?document.addEventListener("DOMContentLoaded",L):L(),document.addEventListener("btfw:layoutReady",L),{name:"feature:playlist-tools"}}),BTFW.define("feature:playlistSearch",["core","bridge"],async function(){function t(){var t,e,n,o=document.getElementById("queuecontainer"),r=document.getElementById("queue");if(r&&(o||((o=document.createElement("div")).id="queuecontainer",o.className="section",r.parentNode.insertBefore(o,r),o.appendChild(r)),!o.querySelector(".btfw-pl-search"))){var i=document.createElement("div");i.className="btfw-pl-search-wrap",i.innerHTML="<input type='text' class='btfw-pl-search' placeholder='Search playlist'>",o.insertBefore(i,o.firstChild);var l=i.querySelector("input");l.addEventListener("keyup",(t=function(){for(var t=l.value.trim().toLowerCase(),e=r.children,n=0;n<e.length;n++){var o=e[n],i=o.textContent.toLowerCase().indexOf(t)>=0;o.style.display=i?"":"none"}},e=150,n=null,function(){clearTimeout(n);var o=arguments;n=setTimeout(function(){t.apply(null,o)},e)}))}}return"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t):t(),{}});