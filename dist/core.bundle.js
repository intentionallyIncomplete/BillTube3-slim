function findNavbarElement(){const t=["nav.navbar",".navbar-fixed-top","#navbar"];for(const e of t){const t=document.querySelector(e);if(t)return t}return null}BTFW.define("feature:styleCore",[],async()=>{function t(){if(!Array.from(document.querySelectorAll('link[rel="stylesheet"]')).some(t=>/(bootstrap.*\.css|bootswatch.*slate)/i.test(t.href||""))&&!document.querySelector("link[data-btfw-slate]")){const t=document.createElement("link");t.rel="stylesheet",t.href="https://cdn.jsdelivr.net/npm/bootswatch@3.4.1/slate/bootstrap.min.css",t.dataset.btfwSlate="1",document.head.insertBefore(t,document.head.firstChild)}}function e(){if(!document.querySelector('link[href*="bulma.min.css"]')&&!document.querySelector("link[data-btfw-bulma]")){const t=document.createElement("link");t.rel="stylesheet",t.href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css",t.dataset.btfwBulma="1",document.head.appendChild(t)}if(!document.querySelector("link[data-btfw-fa6]")&&!document.querySelector('link[href*="fontawesome"]')){const t=document.createElement("link");t.rel="stylesheet",t.href="https://cdn.jsdelivr.net/gh/ElBeyonder/font-awesome-6.5.2-pro-full@master/css/all.css",t.dataset.btfwFa6="1",document.head.appendChild(t)}if(!document.getElementById("btfw-modal-zfix-core")){const t=document.createElement("style");t.id="btfw-modal-zfix-core",t.textContent="\n        /* Keep navbar on top */\n        #nav-collapsible, .navbar, #navbar, .navbar-fixed-top {\n          position: sticky !important;\n          top: 0;\n          left: 0;\n          right: 0;\n          z-index: 5000 !important;\n        }\n        /* Bulma modal layered correctly above content */\n        .modal { z-index: 6000 !important; }\n        .modal .modal-background { z-index: 6001 !important; }\n        .modal .modal-card, .modal .modal-content { z-index: 6002 !important; }\n\n        /* Userlist overlay default CLOSED (chat module toggles classes) */\n        #userlist.btfw-userlist-overlay:not(.btfw-userlist-overlay--open) {\n          display: none !important;\n        }\n      ",document.head.appendChild(t)}}t(),setTimeout(t,400),e(),setTimeout(e,300);try{localStorage.setItem("cytube-layout","fluid"),localStorage.setItem("layout","fluid"),"function"==typeof window.setPreferredLayout&&window.setPreferredLayout("fluid")}catch(t){}return{name:"feature:styleCore"}}),BTFW.define("feature:bulma-layer",[],async()=>{const t="btfw:theme:mode",e=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)");let n;function a(){try{const e=localStorage.getItem(t);if(e)return e;return localStorage.getItem("btfw:bulma:theme")||"dark"}catch(t){return"dark"}}function o(t){const a="auto"===t?e&&e.matches?"dark":"light":t||"dark",o=document.documentElement;o.setAttribute("data-btfw-theme",a),o.classList.toggle("btfw-theme-dark","dark"===a),function(t){const e="dark"===t?"dark":"light";let n=document.querySelector('meta[name="color-scheme"]');n||(n=document.createElement("meta"),n.setAttribute("name","color-scheme"),document.head.appendChild(n)),n.setAttribute("content",e)}(a);(n||(n=document.createElement("style"),n.id="btfw-bulma-dark-bridge",document.head.appendChild(n),n)).textContent="dark"===a?'\n/* --- Global dark scope --- */\nhtml[data-btfw-theme="dark"] { color-scheme: dark; }\nhtml[data-btfw-theme="dark"], html[data-btfw-theme="dark"] body {\n  background: var(--btfw-color-bg);\n  color: var(--btfw-color-text);\n}\nhtml[data-btfw-theme="dark"] body {\n  background-image: none;\n}\n\n/* Text/surfaces (Bulma) */\nhtml[data-btfw-theme="dark"] .content,\nhtml[data-btfw-theme="dark"] .title,\nhtml[data-btfw-theme="dark"] .subtitle,\nhtml[data-btfw-theme="dark"] p,\nhtml[data-btfw-theme="dark"] small {\n  color: var(--btfw-color-text);\n}\n\nhtml[data-btfw-theme="dark"] .box,\nhtml[data-btfw-theme="dark"] .card,\nhtml[data-btfw-theme="dark"] .panel,\nhtml[data-btfw-theme="dark"] .menu,\nhtml[data-btfw-theme="dark"] .notification,\nhtml[data-btfw-theme="dark"] .dropdown-content,\nhtml[data-btfw-theme="dark"] .modal-card {\n  background: color-mix(in srgb, var(--btfw-color-surface) 92%, transparent 8%) !important;\n  color: var(--btfw-color-text) !important;\n  border: 1px solid var(--btfw-border) !important;\n  box-shadow: 0 18px 42px color-mix(in srgb, var(--btfw-color-bg) 55%, transparent 45%);\n}\n\nhtml[data-btfw-theme="dark"] .tabs.is-boxed li a { background:transparent; border-color:transparent; color:#c8d4e0; }\nhtml[data-btfw-theme="dark"] .tabs.is-boxed li.is-active a {\n  background: color-mix(in srgb, var(--btfw-color-panel) 82%, transparent 18%);\n  color: var(--btfw-color-text);\n  border-color: var(--btfw-border);\n}\n\n/* Inputs */\nhtml[data-btfw-theme="dark"] .input,\nhtml[data-btfw-theme="dark"] .textarea,\nhtml[data-btfw-theme="dark"] .select select {\n  background: color-mix(in srgb, var(--btfw-color-panel) 94%, transparent 6%) !important;\n  color: var(--btfw-color-text) !important;\n  border-color: color-mix(in srgb, var(--btfw-border) 80%, transparent 20%) !important;\n}\nhtml[data-btfw-theme="dark"] .input::placeholder,\nhtml[data-btfw-theme="dark"] .textarea::placeholder {\n  color: color-mix(in srgb, var(--btfw-color-text) 55%, transparent 45%) !important;\n}\n\n/* Buttons */\nhtml[data-btfw-theme="dark"] .button,\nhtml[data-btfw-theme="dark"] .btn {\n  background: color-mix(in srgb, var(--btfw-color-panel) 88%, transparent 12%);\n  color: var(--btfw-color-text);\n  border: 1px solid color-mix(in srgb, var(--btfw-border) 70%, transparent 30%);\n}\nhtml[data-btfw-theme="dark"] .button:hover,\nhtml[data-btfw-theme="dark"] .btn:hover {\n  filter: brightness(1.05);\n}\nhtml[data-btfw-theme="dark"] .button.is-link,\nhtml[data-btfw-theme="dark"] .button.is-primary {\n  background: color-mix(in srgb, var(--btfw-color-accent) 82%, transparent 18%) !important;\n  border-color: color-mix(in srgb, var(--btfw-color-accent) 68%, transparent 32%) !important;\n  color: var(--btfw-color-on-accent) !important;\n}\n\n/* Chat/stack surfaces you themed */\nhtml[data-btfw-theme="dark"] #chatwrap,\nhtml[data-btfw-theme="dark"] #messagebuffer { background:transparent; }\n\n/* --- Bulma modal dark --- */\nhtml[data-btfw-theme="dark"] .modal { z-index: 6000 !important; }\nhtml[data-btfw-theme="dark"] .modal .modal-background { background-color: color-mix(in srgb, var(--btfw-color-bg) 88%, transparent 12%) !important; }\nhtml[data-btfw-theme="dark"] .modal-card-head,\nhtml[data-btfw-theme="dark"] .modal-card-foot {\n  background-color: color-mix(in srgb, var(--btfw-color-panel) 92%, transparent 8%) !important;\n  border-color: var(--btfw-border) !important;\n  color: var(--btfw-color-text) !important;\n}\nhtml[data-btfw-theme="dark"] .modal-card {\n  background-color: color-mix(in srgb, var(--btfw-color-surface) 94%, transparent 6%) !important;\n  color: var(--btfw-color-text) !important;\n}\nhtml[data-btfw-theme="dark"] .modal-card-title { color: var(--btfw-color-text) !important; }\n\n/* --- Bootstrap/CyTube modal bridge (skin Bootstrap modals to match Bulma dark) --- */\nhtml[data-btfw-theme="dark"] .modal.fade,\nhtml[data-btfw-theme="dark"] .modal.in,\nhtml[data-btfw-theme="dark"] .modal { z-index: 6000 !important; }\nhtml[data-btfw-theme="dark"] .modal-backdrop {\n  background-color: color-mix(in srgb, var(--btfw-color-bg) 88%, transparent 12%) !important; z-index: 0 !important;\n}\nhtml[data-btfw-theme="dark"] .modal-dialog { max-width: 880px; }\nhtml[data-btfw-theme="dark"] .modal-content {\n  background-color: color-mix(in srgb, var(--btfw-color-surface) 94%, transparent 6%) !important;\n  color: var(--btfw-color-text) !important;\n  border:1px solid var(--btfw-border) !important;\n}\n@media screen and (min-width: 769px) {\n  .modal-card, .modal-content {\n    width: auto;\n    max-width: 55rem;\n  }\n}\nhtml[data-btfw-theme="dark"] .modal-header,\nhtml[data-btfw-theme="dark"] .modal-footer {\n  background-color: color-mix(in srgb, var(--btfw-color-panel) 92%, transparent 8%) !important;\n  border-color: var(--btfw-border) !important;\n  color: var(--btfw-color-text) !important;\n}\nhtml[data-btfw-theme="dark"] .modal-title { color: var(--btfw-color-text) !important; }\nhtml[data-btfw-theme="dark"] .modal .btn-primary {\n  background: color-mix(in srgb, var(--btfw-color-accent) 82%, transparent 18%) !important;\n  border-color: color-mix(in srgb, var(--btfw-color-accent) 68%, transparent 32%) !important;\n  color: var(--btfw-color-on-accent) !important;\n}\nhtml[data-btfw-theme="dark"] .modal .btn-default {\n  background: color-mix(in srgb, var(--btfw-color-panel) 88%, transparent 12%) !important;\n  border-color: color-mix(in srgb, var(--btfw-border) 70%, transparent 30%) !important;\n  color: var(--btfw-color-text) !important;\n}\n/* Scroll lock (Bootstrap) */\nbody.modal-open { overflow: hidden; }\n':""}function r(){return a()}function d(){o(a()),e&&e.addEventListener&&e.addEventListener("change",()=>{"auto"===r()&&o("auto")})}return"loading"===document.readyState?document.addEventListener("DOMContentLoaded",d):d(),{name:"feature:bulma-layer",setTheme:function(e){const n="auto"===e||"dark"===e||"light"===e?e:"dark";!function(e){try{localStorage.setItem(t,e)}catch(t){}}(n),o(n)},getTheme:r}}),BTFW.define("feature:bulma",["feature:bulma-layer"],async({})=>({name:"feature:bulma"})),BTFW.define("feature:layout",["feature:styleCore","feature:bulma"],async({})=>{const t="btfw:grid:leftPx",e="btfw-navhost",n=520;let a=null,o="right",r=!1,d=null;function l(){const t=document.getElementById("videowrap");if(!t)return;t.querySelectorAll("iframe, video").forEach(t=>{t.style.removeProperty("height"),t.style.removeProperty("width"),t.style.removeProperty("maxHeight")});const e=t.querySelector(".video-js");if(e){const t=e.player||e.player_||window.videojs&&(window.videojs.players?.[e.id]||window.videojs(e.id));if(t)try{"function"==typeof t.trigger&&t.trigger("componentresize"),t.tech_&&"function"==typeof t.tech_.trigger&&t.tech_.trigger("resize"),"function"==typeof t.resize&&t.resize()}catch(t){}}}function c(){const t=document.getElementById("btfw-grid");if(!t)return;if(r)return t.style.gridTemplateColumns="",void t.classList.remove("btfw-grid--chat-left","btfw-grid--chat-right");const e=a?Math.max(a,n):null,d=e?`minmax(520px, ${e}px)`:"minmax(520px, 7fr)",l=e?"minmax(var(--btfw-chat-min, 320px), 1fr)":"minmax(var(--btfw-chat-min, 320px), 3fr)",c="left"===o?`${l} var(--btfw-split-width, 8px) ${d}`:`${d} var(--btfw-split-width, 8px) ${l}`;t.style.gridTemplateColumns=c,t.classList.toggle("btfw-grid--chat-left","left"===o),t.classList.toggle("btfw-grid--chat-right","left"!==o)}function i(){const t=document.getElementById("btfw-stack");if(t)if(r){t.classList.add("btfw-stack--in-chat");const e=document.getElementById("btfw-chatcol");if(!e)return;const n=document.getElementById("chatwrap");n&&n.parentElement===e?n.nextSibling!==t&&e.insertBefore(t,n.nextSibling):t.parentElement!==e&&e.appendChild(t)}else{t.classList.remove("btfw-stack--in-chat");const e=document.getElementById("btfw-leftpad");if(!e)return;const n=document.getElementById("videowrap");n&&n.parentElement===e?n.nextSibling!==t&&(n.nextSibling?e.insertBefore(t,n.nextSibling):e.appendChild(t)):t.parentElement!==e&&e.appendChild(t)}}function m(){const t=document.getElementById("btfw-mobile-modules-toggle");if(!t)return;if(t===d&&t._btfwNavWired)return;d&&d._btfwNavStateHandler&&document.removeEventListener("btfw:navbar:mobileState",d._btfwNavStateHandler),d=t,t._btfwNavWired=!0,t.setAttribute("aria-haspopup","menu");const e=(e,n)=>{const a=document.getElementById("btfw-navhost"),o=n??(!!a&&a.classList.contains("btfw-navhost--mobile")),r=!!e&&o;t.setAttribute("aria-expanded",o&&r?"true":"false");const d=o&&r?"Close navigation menu":"Open navigation menu";t.setAttribute("aria-label",d),t.title=d,t.classList.toggle("btfw-mobile-modules-toggle--active",o&&r)},n=t=>{e(t?.detail?.open,t?.detail?.mobile)};document.addEventListener("btfw:navbar:mobileState",n),t._btfwNavStateHandler=n,t.addEventListener("click",t=>{t.preventDefault();const e=document._btfw_nav_toggleMobile,n=document._btfw_nav_setMobileOpen;if("function"==typeof e)e();else if("function"==typeof n){n(!("function"==typeof document._btfw_nav_isMobileOpen&&document._btfw_nav_isMobileOpen()))}});const a="function"==typeof document._btfw_nav_isMobileOpen&&document._btfw_nav_isMobileOpen(),o=document.getElementById("btfw-navhost")?.classList.contains("btfw-navhost--mobile")||!1;e(a,o)}function s(){const t=document.getElementById("btfw-grid");if(!t)return;m();const e=window.innerWidth<function(){const t=Math.max(a||680,n)+360+20;return Math.min(Math.max(t,900),940)}();e!==r?(r=e,t.classList.toggle("btfw-grid--vertical",e),document.body&&document.body.classList.toggle("btfw-mobile-stack-enabled",e),i(),l(),setTimeout(()=>{l();try{window.dispatchEvent(new Event("resize"))}catch(t){}},60),document.dispatchEvent(new CustomEvent("btfw:layout:orientation",{detail:{vertical:e}}))):i(),c(),f(),e||l()}function f(){const t=document.querySelector(".navbar, #nav-collapsible, #navbar, .navbar-fixed-top"),e=(t?t.offsetHeight:48)+"px";document.documentElement.style.setProperty("--btfw-top",e);const n=document.getElementById("btfw-chatcol");n&&(r?(n.style.top="0px",n.style.height=""):(n.style.top=`calc(${e} + var(--btfw-gap))`,n.style.height=`calc(100vh - ${e} - var(--btfw-gap) * 2)`))}function u(){const e=document.getElementById("btfw-grid"),d=document.getElementById("btfw-vsplit");if(!e||!d)return void console.warn("[BTFW] Resizer elements not found.");let l=!1;function i(i){if(!l||r)return;const m=e.getBoundingClientRect(),s=d.getBoundingClientRect().width||parseFloat(getComputedStyle(d).width)||6;let f;if("left"===o){const t=i.clientX-m.left,e=Math.max(t-s/2,0),a=m.width-e-s;if(a<n||e<360)return;f=a}else{f=i.clientX-m.left;const t=m.width-f-s;if(f<n||t<360)return}Number.isFinite(f)&&function(e){if(!Number.isFinite(e))return;const o=Math.max(e,n);a=o;try{localStorage.setItem(t,String(o))}catch(t){}c()}(f)}function m(){l&&(l=!1,document.body.classList.remove("btfw-resizing"),document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",m),s())}d.addEventListener("mousedown",t=>{r||(l=!0,t.preventDefault(),document.body.classList.add("btfw-resizing"),document.addEventListener("mousemove",i),document.addEventListener("mouseup",m))})}const b=/^(col(-(xs|sm|md|lg|xl))?-(\d+|auto)|row|container(-fluid)?|pull-(left|right)|offset-\d+)$/;function h(){const t=document.getElementById("wrap")||document.body,e=document.getElementById("videowrap"),n=document.getElementById("chatwrap"),a=document.getElementById("playlistrow")||document.getElementById("playlistwrap")||document.getElementById("queuecontainer");if(document.getElementById("btfw-grid")){const t=document.getElementById("btfw-leftpad"),e=document.getElementById("btfw-chatcol"),n=document.getElementById("videowrap"),a=document.getElementById("chatwrap"),o=document.getElementById("playlistrow")||document.getElementById("playlistwrap")||document.getElementById("queuecontainer");w(document.getElementById("btfw-grid")),n&&!t.contains(n)&&t.appendChild(n),o&&!t.contains(o)&&t.appendChild(o),a&&!e.contains(a)&&e.appendChild(a)}else{const o=document.createElement("div");o.id="btfw-grid";const r=document.createElement("div");r.id="btfw-leftpad";const d=document.createElement("aside");d.id="btfw-chatcol",e&&r.appendChild(e),a&&r.appendChild(a),n&&d.appendChild(n);const l=document.createElement("div");l.id="btfw-vsplit",w(o),o.appendChild(r),o.appendChild(l),o.appendChild(d),o.style.opacity="0",t.prepend(o)}["videowrap","playlistrow","playlistwrap","queuecontainer","queue","plmeta","chatwrap","controlsrow","rightcontrols"].forEach(t=>{var e;(e=document.getElementById(t))&&((e.classList||[]).forEach(t=>{b.test(t)&&e.classList.remove(t)}),e.querySelectorAll("[class]").forEach(t=>{Array.from(t.classList).forEach(e=>{b.test(e)&&t.classList.remove(e)})}))}),function(){const t=document.getElementById("videowrap-header");if(!t)return void console.log("[layout] No videowrap-header found");const e=t.querySelector("#currenttitle"),n=document.querySelector("#chatwrap .btfw-chat-topbar");if(n){let t=n.querySelector("#btfw-nowplaying-slot");t||(t=document.createElement("div"),t.id="btfw-nowplaying-slot",t.className="btfw-chat-title",n.innerHTML="",n.appendChild(t)),e?(t.appendChild(e),console.log("[layout] Moved #currenttitle to slot")):console.log("[layout] No #currenttitle found in videowrap-header")}t.remove()}(),i()}function p(){h(),function(){try{const e=parseInt(localStorage.getItem(t)||"",10);!isNaN(e)&&e>=n&&(a=e)}catch(t){a=null}}(),o=function(){try{return"left"===localStorage.getItem("btfw:layout:chatSide")?"left":"right"}catch(t){return"right"}}(),c(),f(),s();const e=()=>{f(),u(),function(){const t=document.getElementById("btfw-grid");t&&(t.classList.add("btfw-loaded"),t.style.opacity="1"),s(),document.dispatchEvent(new CustomEvent("btfw:layoutReady"))}()};setTimeout(e,100),setTimeout(e,300),setTimeout(e,600),"complete"===document.readyState?e():window.addEventListener("load",e);const r=document.querySelector(".navbar, #nav-collapsible, #navbar, .navbar-fixed-top");if(r){new ResizeObserver(()=>{setTimeout(f,0),setTimeout(s,0)}).observe(r)}window.addEventListener("resize",()=>{setTimeout(()=>{f(),s()},0)})}function w(t){if(!t)return;const n=function(){const t=["nav.navbar",".navbar-fixed-top","#navbar"];for(const e of t){const t=document.querySelector(e);if(t)return t}return null}();if(!n)return;let a=document.getElementById(e);a||(a=document.createElement("div"),a.id=e,a.className="btfw-navhost"),n.parentElement!==a&&a.appendChild(n),a.parentElement!==t&&t.insertBefore(a,t.firstChild)}return document.addEventListener("btfw:layout:chatSideChanged",t=>{const e=t&&t.detail&&"left"===t.detail.side?"left":"right";o=e,c(),s()}),document.addEventListener("btfw:chat:barsReady",()=>{m(),i()}),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",p):p(),{name:"feature:layout"}});